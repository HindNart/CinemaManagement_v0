<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${movie.tenPhim}"></title>
    <link rel="stylesheet" href="/css/filmStyle.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
	    document.addEventListener("DOMContentLoaded", function () {
	        var modalToggleButtons = document.querySelectorAll('.schedule-time-item');
	        
	
	        modalToggleButtons.forEach(button => {
	            button.addEventListener('click', function () {
	                var startTime = button.getAttribute('data-start-time');
	                var endTime = button.getAttribute('data-end-time');
	                var showTime = button.getAttribute('data-show-time');
	                var room = button.getAttribute('data-room');
	                var roomType = button.getAttribute('data-room-type');
	                // Update content in the modal
	                var modalTimeElement = document.getElementById("timeSchedule");
	                modalTimeElement.value = startTime + ' ~ ' + endTime;
	                
	                var modalTimeElement2 = document.getElementById("showTime");
	                modalTimeElement2.value = showTime;
	                
	                var modalTimeElement3 = document.getElementById("showRoom");
	                modalTimeElement3.textContent = room;
	                
	                var modalTimeElement3 = document.getElementById("roomType");
	                modalTimeElement3.textContent = roomType;
	                // Close the dropdown if it's open (optional)
	                var dropdown = document.querySelector('.dropdown-content');
	                dropdown.classList.remove('show');
	
	                // Optionally, you can trigger the modal opening programmatically
	                var modalToggle = new bootstrap.Modal(document.getElementById('exampleModalToggle'));
	                modalToggle.show();
	            });
	        });
	    });

        document.addEventListener("DOMContentLoaded", function () {
            let listChoosen = document.getElementById("seat-chosens");

            function addSeat(button) {
                var chairValue = button.value;

                // Ki·ªÉm tra xem gh·∫ø ƒë√£ ƒë∆∞·ª£c ch·ªçn hay ch∆∞a
                var existingSeats = listChoosen.querySelectorAll(".seat-chosen");
                for (var i = 0; i < existingSeats.length; i++) {
                    if (existingSeats[i].textContent === chairValue) {
                        alert("Gh·∫ø n√†y ƒë√£ ƒë∆∞·ª£c ch·ªçn!");
                        return;
                    }
                }

                // T·∫°o m·ªôt ph·∫ßn t·ª≠ m·ªõi ƒë·ªÉ ch·ª©a th√¥ng tin gh·∫ø
                let seat = document.createElement("div");
                seat.className = "seat-chosen";
                seat.textContent = chairValue;
                listChoosen.appendChild(seat);
                seat.addEventListener("click", function () {
                    listChoosen.removeChild(seat);
                });
            }

            // G√°n h√†m addSeat cho c√°c n√∫t gh·∫ø
            var seatButtons = document.querySelectorAll(".normal-seat, .vip-seat, .couple-seat");
            seatButtons.forEach(button => {
                button.addEventListener("click", function () {
                    addSeat(button);
                });
            });
        });
        function loadContent(fragment) {
            fetch(fragment)
                .then(response => response.text())
                .then(data => {
                    document.getElementById('content').innerHTML = data;
                })
                .catch(error => console.error('Error loading content:', error));
        }
    </script>
</head>
<body>
    <div id="header">
        <div class="navbar">
            <div class="logo"></div>
            <div class="nav-content">
                <ul>
                    <li class="nav-dropdown">L·ªãch chi·∫øu
                        <div class="dropdown-content">
                            <a href="#">Phim ƒëang chi·∫øu</a>
                            <a href="#">Phim s·∫Øp chi·∫øu</a>
                        </div>
                    </li>
                    <li>Phim chi·∫øu</li>
                    <li>Review phim</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="film-info pa-64">
        <div class="film-info-img"><img th:src="${movie.LinkPoster}" alt="" width="250px" height="350px"></div>
        <div class="film-info-details">
            <p class="ageFilm margin-tb-10">P</p>
            <h1 th:text="${movie.tenPhim}"></h1>
            <p class="opacity-7 margin-tb-10" th:text="${movie.tenPhim}"> ¬∑ <p th:text="${movie.thoiLuong}">ph√∫t</p> </p>
            <p>üåü 9 </p>
            <p class="opacity-7 margin-tb-10">T√ÅC PH·∫®M K·ª∂ NI·ªÜM 90 NƒÇM FUJIKO F FUJIO</p>
            <b>N·ªôi dung</b>
            <p class="opacity-7" th:text="${movie.moTa}"></p>
            <div class="flex justify-content-between margin-tb-10">
                <div class="">
                    <p class="opacity-7">Ng√†y chi·∫øu</p>
                    <b th:text="${movie.ngayPH}"></b>
                </div>
                <div class="">
                    <p class="opacity-7">Th·ªÉ lo·∫°i</p>
                    <b th:text="${movie.theLoai}"></b>
                </div>
            </div>
        </div>
    </div>
    <div class="schedule-show pa-64">
        <h3>L·ªãch chi·∫øu <span th:text="${movie.tenPhim}"></span></h3>
        <div class="schedule-container" th:each="date : ${uniqueDates}">
            <div class="schedule-list"  >
                <div class="schedule-date">
                    <p class="bg-gray" th:text="${date}"></p>
                </div>
            </div>
            <div class="schedule-time-container">
                <div class="schedule-time">
                    <p><b>2D L·ªìng ti·∫øng</b></p>
                    <div class="" style="margin-left:-3px;" >                	
                        <div  th:each="schedule : ${movieSchedule}"
                        	th:if="${date == schedule.ngayChieu}"  
                        	class="schedule-time-item btn btn-primary ms-1 me-1" data-bs-target="#exampleModalToggle"  
                            data-bs-toggle="modal"
                            th:attr="data-start-time=${schedule.thoigianBD}, data-end-time=${schedule.thoigianKT}, data-show-time=${schedule.ngayChieu}, data-room=${schedule.phongChieu.idPhong},data-room-type=${schedule.phongChieu.loaiPhong}">
                            <a class="text-white" style="text-decoration: none" th:href="@{/showBuyTicket/{id}(id=${schedule.idLichChieu})}"><span th:text="${schedule.thoigianBD}"></span> ~ <span th:text="${schedule.thoigianKT}"></span></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalToggleLabel2">Modal 2</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Hide this modal and show the first with the button below.
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal">Back to first</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
