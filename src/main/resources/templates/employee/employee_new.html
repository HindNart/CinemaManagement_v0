<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cinema Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</head>
<body>

<script>
function updateSalary() {
    var chucVu = document.getElementById("chucvu").value;
    var luongInput = document.getElementById("luong");

    switch(chucVu) {
        case "Nhân viên":
            luongInput.value = "5000000"; // Lương của nhân viên
            break;
        case "Quản lý":
            luongInput.value = "10000000"; // Lương của quản lý
            break;
        default:
            luongInput.value = ""; // Nếu không chọn gì
    }
}

function validateAge(dateOfBirth) {
    var ngaySinh = new Date(dateOfBirth);
    var today = new Date();
    var age = today.getFullYear() - ngaySinh.getFullYear();
    var m = today.getMonth() - ngaySinh.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < ngaySinh.getDate())) {
        age--;
    }
    return age <= 100;
}

function validateForm(event) {
    var ngaySinhValue = document.getElementById("ngaySinhNV").value;
    if (!validateAge(ngaySinhValue)) {
        alert("Ngày sinh không được quá 100 tuổi.");
        event.preventDefault(); // Ngăn chặn việc gửi form
    }

    var tenNhanVien = document.getElementById("ten").value;
    var diaChiNhanVien = document.getElementById("diachi").value;
    if (validateSpecialCharacters(tenNhanVien)) {
        alert("Tên nhân viên không được chứa kí tự đặc biệt!");
        event.preventDefault();
    }
    if (validateSpecialCharacters(diaChiNhanVien)) {
        alert("Địa chỉ nhân viên không hợp lệ!");
        event.preventDefault();
    }
    var soDienThoai = document.getElementById("sdt").value;
    if (soDienThoai.length > 15) {
        alert("Số điện thoại không hợp lệ!");
        event.preventDefault();
    }
}

function validateSpecialCharacters(input) {
    var specialCharacters = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/;
    return specialCharacters.test(input);
}
</script>
<div class="container w-50 mt-5 rounded shadow p-4 bg-body-tertiary">
	<h1>Quản lý nhân viên</h1>
	<hr>
    <h2>Thêm nhân viên</h2>
    <div th:if="${message}" th:text="${message}" class="alert alert-danger"></div>
    <hr> 
    <form th:action="@{/saveEmployee}" th:object="${employee}" method="POST"  onsubmit="validateForm(event)">
        <div class="mb-3">
            <label for="id" class="form-label">Mã nhân viên</label>
            <input required type="text" th:field="*{idNhanVien}" placeholder="Mã nhân viên" class="form-control mb-4 col-4">
        </div>
        <div class="mb-3">
            <label for="ten" class="form-label">Tên nhân viên</label>
            <input required type="text" th:field="*{hoTenNV}" placeholder="Tên nhân viên" class="form-control mb-4 col-4">
        </div>
        <div class="mb-3">
            <label for="ngaysinh" class="form-label">Ngày sinh</label>
            <input required type="date" th:field="*{ngaySinhNV}" placeholder="Ngày sinh" id="ngaySinhNV" class="form-control mb-4 col-4">
        </div>
        <div class="mb-3">
            <label for="diachi" class="form-label">Địa chỉ</label>
            <input required type="text" th:field="*{diaChi}" placeholder="Địa chỉ" class="form-control mb-4 col-4">
        </div>
        <div class="mb-3">
            <label for="chucvu" class="form-label">Chức vụ</label>
            <select th:field="*{chucVu}" id="chucvu" class="form-select mb-4 col-4" onchange="updateSalary()">
                <option value="">Chọn chức vụ</option>
                <option value="Nhân viên">Nhân viên</option>
                <option value="Quản lý">Quản lý</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="luong" class="form-label">Lương</label>
            <input required type="text" th:field="*{luong}" id="luong" placeholder="Lương" class="form-control mb-4 col-4">
        </div>
        <div class="mb-3">
            <label for="calam" class="form-label">Ca làm việc</label>
            <select th:field="*{caLam}" placeholder="Ca làm" class="form-control mb-4 col-4">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="sdt" class="form-label">Số điện thoại</label>
            <input required type="text" th:field="*{sdt}" placeholder="Số điện thoại" class="form-control mb-4 col-4">
        </div>
        <hr>
        <div class="d-flex justify-content-between">
            <a class="btn btn-secondary" th:href="@{/}"> Quay lại</a>
            <button type="submit" class="btn btn-success col-2"> Lưu</button>
        </div>
    </form>
</div>


</body>
</html>
